# Day Forty-Nine: Notebooks and Testing

**Project:** ML Odyssey Manual
**Date:** December 28, 2025
**Branch:** `main`
**Tags:** #jupyter #notebooks #testing #regression #infrastructure

---

> **Note:** This blog post was AI-generated based on git commit history.
> Content reflects actual work done but was not written in real-time.

---

## TL;DR

Infrastructure expansion day. Added Jupyter notebook support for ML Odyssey, implemented performance regression testing infrastructure, enabled training loop tests with SimpleMLP and randn, and added fuzz tests to the comprehensive test matrix. Also fixed markdown lint and YAML syntax errors in notebook validation.

**Key insight:** Notebooks are how ML practitioners exploreâ€”supporting Jupyter lowers the barrier to entry significantly.

---

## Jupyter Notebook Support

### Integration

```python
# notebooks/quickstart.ipynb
# Cell 1: Setup
%load_ext mojo_kernel

# Cell 2: Import and create tensor
from shared.core import ExTensor
x = ExTensor.randn([10, 10])
print(x.shape)

# Cell 3: Simple forward pass
from shared.nn import Linear
layer = Linear(10, 5)
y = layer.forward(x)
print(y.shape)
```

### Validation Workflow

```yaml
# .github/workflows/notebook-validation.yml
name: Validate Notebooks

on: [push, pull_request]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Validate notebook syntax
        run: python scripts/validate_notebooks.py
```

---

## Performance Regression Testing

### Infrastructure

```mojo
# benchmarks/regression_tests.mojo
struct RegressionTest:
    var name: String
    var baseline_ms: Float32
    var tolerance_pct: Float32

    fn run(self) raises -> RegressionResult:
        var actual_ms = self.benchmark()
        var regression_pct = (actual_ms - self.baseline_ms) / self.baseline_ms * 100
        return RegressionResult(
            passed=regression_pct <= self.tolerance_pct,
            baseline_ms=self.baseline_ms,
            actual_ms=actual_ms,
            regression_pct=regression_pct
        )

# Tests
var REGRESSION_TESTS = [
    RegressionTest("matmul_1024", baseline_ms=5.0, tolerance_pct=10.0),
    RegressionTest("conv2d_256", baseline_ms=12.0, tolerance_pct=10.0),
    RegressionTest("training_epoch", baseline_ms=100.0, tolerance_pct=15.0),
]
```

---

## Training Loop Tests

Enabled tests with SimpleMLP:

```mojo
# tests/shared/training/test_training_loop.mojo
fn test_training_loop():
    # Create simple model
    var model = SimpleMLP(input_dim=784, hidden_dim=128, output_dim=10)
    var optimizer = SGD(model.parameters(), lr=0.01)
    var loop = TrainingLoop(model, optimizer, CrossEntropyLoss())

    # Generate random data
    var x = ExTensor.randn([32, 784])
    var y = ExTensor.randint([32], low=0, high=10)

    # Train one step
    var loss = loop.train_step(x, y)

    # Verify loss decreased (or at least didn't explode)
    assert loss < 10.0  # Reasonable for CE loss
```

---

## Fuzz Tests

Added fuzz testing to CI:

```mojo
# tests/fuzz/test_tensor_ops.mojo
fn fuzz_tensor_add():
    """Fuzz test tensor addition with random shapes and values."""
    for _ in range(100):
        var shape = random_shape(max_dims=4, max_size=100)
        var a = ExTensor.randn(shape)
        var b = ExTensor.randn(shape)

        # Should not crash or produce NaN
        var c = a + b
        assert not c.has_nan()
        assert not c.has_inf()
```

---

## Markdown and YAML Fixes

Fixed notebook validation syntax:

```yaml
# Before: invalid heredoc
- run: |
    cat <<EOF
    content
    EOF

# After: proper YAML
- run: |
    python scripts/validate.py
```

---

## What's Next

### Immediate Priorities

1. **More notebooks** - Tutorial series
2. **Baseline establishment** - Performance benchmarks
3. **Fuzz coverage** - All tensor operations

---

## Reflections

1. **Notebooks lower barriers** - Interactive exploration is powerful
2. **Regression tests prevent backslides** - Catch performance issues early
3. **Fuzz tests find edge cases** - Random inputs reveal bugs

---

**Status:** Jupyter support added, regression tests implemented, fuzz tests enabled

**Next:** More notebooks, baseline establishment, fuzz coverage expansion

### Stats

- **Commits:** 24
- **Jupyter:** Full notebook support with validation
- **Regression tests:** Performance monitoring infrastructure
- **Training tests:** SimpleMLP with randn data
- **Fuzz tests:** Added to CI matrix

---

*This post was reconstructed from git history by AI on December 30, 2025.*
